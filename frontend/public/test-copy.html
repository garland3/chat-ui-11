<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copy Message Test</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #111827;
            color: #f3f4f6;
            padding: 20px;
        }
        .message {
            max-width: 600px;
            background: #374151;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
        }
        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .message-author {
            font-weight: 600;
            font-size: 14px;
            color: #d1d5db;
        }
        .copy-button {
            opacity: 0;
            background: #4b5563;
            border: 1px solid #6b7280;
            color: #f3f4f6;
            padding: 6px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .message:hover .copy-button {
            opacity: 1;
        }
        .copy-button:hover {
            background: #6b7280;
        }
        .copy-button.success {
            background: #059669;
            border-color: #10b981;
        }
        .message-content {
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h1>Copy Message Functionality Test</h1>
    
    <div class="message">
        <div class="message-header">
            <div class="message-author">Chat UI</div>
            <button class="copy-button" onclick="copyMessage(this)" title="Copy message to clipboard">
                <i data-lucide="copy"></i>
            </button>
        </div>
        <div class="message-content">
            Of course! I'd be happy to help you with React. React is a popular JavaScript library for building user interfaces, particularly web applications.

Here are some key concepts:

## Core Concepts

1. **Components** - Reusable pieces of UI
2. **JSX** - JavaScript syntax extension for writing HTML-like code  
3. **Props** - Data passed to components
4. **State** - Internal component data that can change

```javascript
function MyComponent({ name }) {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <h1>Hello, {name}!</h1>
      <button onClick={() => setCount(count + 1)}>
        Count: {count}
      </button>
    </div>
  );
}
```

What specific aspect of React would you like to learn more about?
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        function copyMessage(button) {
            try {
                // Find the message content
                const messageContent = button.closest('.message').querySelector('.message-content');
                const text = messageContent.textContent.trim();
                
                // Copy to clipboard
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(text).then(() => {
                        showCopySuccess(button);
                    }).catch(err => {
                        console.error('Failed to copy: ', err);
                        fallbackCopy(text, button);
                    });
                } else {
                    fallbackCopy(text, button);
                }
            } catch (err) {
                console.error('Error copying message: ', err);
            }
        }

        function showCopySuccess(button) {
            const icon = button.querySelector('i');
            const originalIcon = icon.getAttribute('data-lucide');
            
            // Change to check icon
            icon.setAttribute('data-lucide', 'check');
            button.classList.add('success');
            lucide.createIcons();
            
            setTimeout(() => {
                icon.setAttribute('data-lucide', originalIcon);
                button.classList.remove('success');
                lucide.createIcons();
            }, 2000);
        }

        function fallbackCopy(text, button) {
            try {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    showCopySuccess(button);
                } else {
                    console.error('Fallback copy failed');
                }
            } catch (err) {
                console.error('Fallback copy error: ', err);
            }
        }
    </script>
</body>
</html>